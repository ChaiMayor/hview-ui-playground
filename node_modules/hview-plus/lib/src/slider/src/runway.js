"use strict";Object.defineProperties(exports,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});const e=require("vue"),D=require("./slider2.js"),I=require("./marker.js"),T=require("@vue/shared"),g=require("./utils.js"),M=require("@hview-plus/utils"),j={key:0,class:"h-slider__stop"},q={name:"HSliderRunway"},A=e.defineComponent({...q,props:D.SliderProps,setup(x,{expose:B}){const t=x,i=e.ref(null),v=e.ref(null),d=e.ref(null),o=e.ref(0),s=e.ref(0),b=e.ref(0),c=e.ref(0),p=e.ref([]),h=e.ref(0),k=e.ref(0),f=e.ref(!1),w=e.ref(0),V=l=>{let n=0;const a=JSON.parse(JSON.stringify(p.value));a.unshift(0),a.push(Number.MAX_SAFE_INTEGER);for(let r=0;r<a.length;r++)if(l<=a[r]){n=g.judgeLocation(l,a[r-1],a[r])==="end"?r:r-1;break}return[a,n]},_=e.computed(()=>t.vertical?{bottom:`${b.value}%`,height:`${c.value}%`}:{left:`${b.value}%`,width:`${c.value}%`}),m=(l,n)=>{let a=0,[r,u]=V(l);u===-1&&(u=0),a=Number(M.toFixed(String(r[u]/t.width*100),0)),n==="btn1"?(o.value=a,h.value=u*t.step+t.min,v.value.btnIndex=u-(u===0?0:1)):(s.value=a,k.value=u*t.step+t.min,d.value.btnIndex=u-(u===0?0:1)),$(),t.formatTooltip&&(h.value=t.formatTooltip(h.value),k.value=t.formatTooltip(k.value))},$=()=>{t.range&&T.isArray(t.modelValue)?(b.value=Math.min(s.value,o.value),c.value=Math.max(s.value,o.value)-Math.min(s.value,o.value)):c.value=o.value},E=l=>{if(t.disabled||f.value)return!1;let n="btn1";if(t.vertical?w.value=M.offsetTop(i.value)+i.value.offsetHeight-l.pageY:w.value=l.pageX-M.offsetLeft(i.value),t.range){let a=v.value.btnIndex>d.value.btnIndex?"start":"end",r=v.value.btnIndex>d.value.btnIndex?v.value.btnIndex:d.value.btnIndex,u=a==="start"?"end":"start",N=a==="start"?d.value.btnIndex:v.value.btnIndex;g.judgeLocation(w.value,p.value[N],p.value[r])===u?n="btn1":n="btn2"}return m(w.value,n),!1},y=e.computed(()=>t.width/(t.max-t.min)),S=()=>{p.value=g.cutChunk(t.width,t.step,t.max-t.min),t.range&&T.isArray(t.modelValue)?(m(y.value*(t.modelValue[0]-t.min),"btn1"),m(y.value*(t.modelValue[1]-t.min),"btn2"),b.value=Math.min(s.value,o.value),c.value=Math.max(s.value,o.value)-Math.min(s.value,o.value)):m(y.value*(t.modelValue-t.min),"btn1")};return e.watch([()=>t.width,()=>t.step,()=>t.max,()=>t.min],()=>{S()}),e.onMounted(()=>{S(),i.value&&i.value.addEventListener("click",E)}),e.onUnmounted(()=>{i.value&&i.value.removeEventListener("click",E)}),B({update:S}),(l,n)=>(e.openBlock(),e.createElementBlock("div",{class:"h-slider__runway",ref_key:"slider_runway",ref:i,style:e.normalizeStyle({height:`${l.height}px`})},[e.createElementVNode("div",{class:"h-slider__bar",style:e.normalizeStyle(e.unref(_))},null,4),l.showStops?(e.openBlock(),e.createElementBlock("div",j,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,(a,r)=>(e.openBlock(),e.createElementBlock("div",{class:"h-slider__stop_item",style:e.normalizeStyle(l.vertical?`bottom: ${a}px`:`left: ${a}px`),key:r},null,4))),128))])):e.createCommentVNode("",!0),e.createVNode(I.default,e.mergeProps({ref_key:"btn1",ref:v},l.$attrs,{"model-value":o.value,placement:l.placement,tip:h.value,isDraw:f.value,"onUpdate:isDraw":n[0]||(n[0]=a=>f.value=a),disabled:l.disabled,showTooltip:l.showTooltip,vertical:l.vertical,yname:"btn1",onSetMarkerSite:m}),null,16,["model-value","placement","tip","isDraw","disabled","showTooltip","vertical"]),l.range?(e.openBlock(),e.createBlock(I.default,e.mergeProps({key:1,ref_key:"btn2",ref:d},l.$attrs,{yname:"btn2",isDraw:f.value,"onUpdate:isDraw":n[1]||(n[1]=a=>f.value=a),placement:l.placement,showTooltip:l.showTooltip,disabled:l.disabled,"model-value":s.value,vertical:l.vertical,tip:k.value,onSetMarkerSite:m}),null,16,["isDraw","placement","showTooltip","disabled","model-value","vertical","tip"])):e.createCommentVNode("",!0)],4))}});exports.default=A;
